{"version":3,"sources":["../../src/services/area.service.ts"],"sourcesContent":["import { hash } from 'bcrypt';\nimport { Area, PrismaClient, User } from '@prisma/client';\nimport { CreateUserDto } from '@dtos/users.dto';\nimport { HttpException } from '@exceptions/HttpException';\nimport { isEmpty } from '@utils/util';\nimport { CreateAreaDto } from '@/dtos/areas.dto';\n\nclass AreaService {\n  public areas = new PrismaClient().area;\n\n  public async getAllAreas(): Promise<Area[]> {\n    const allAreas: Area[] = await this.areas.findMany({\n      where: { active: true },\n      orderBy: {\n        order: 'asc',\n      },\n    });\n    return allAreas;\n  }\n\n  public async getAreaGivenId(id: number): Promise<Area> {\n    if (isEmpty(id)) throw new HttpException(400, 'id is empty');\n\n    const findArea: Area = await this.areas.findUnique({ where: { id: id } });\n    if (!findArea || (findArea && !findArea.active)) throw new HttpException(409, \"Area doesn't exist\");\n\n    return findArea;\n  }\n\n  public async createArea(areaData: CreateAreaDto): Promise<Area> {\n    if (isEmpty(areaData)) throw new HttpException(400, 'userData is empty');\n\n    const findArea: Area = await this.areas.findUnique({ where: { name: areaData.name } });\n    if (findArea) throw new HttpException(409, `Area with title ${areaData.name} already exists`);\n\n    const count = await this.areas.count({ where: { active: true } });\n\n    const createAreaData: Area = await this.areas.create({ data: { ...areaData, order: count + 1 } });\n    return createAreaData;\n  }\n\n  public async updateArea(id: number, data: CreateAreaDto): Promise<Area> {\n    if (isEmpty(data)) throw new HttpException(400, 'userData is empty');\n\n    const findArea: Area = await this.areas.findUnique({ where: { id: id } });\n    if (!findArea || (findArea && !findArea.active)) throw new HttpException(409, \"User doesn't exist\");\n\n    const newArea = await this.areas.update({ where: { id: id }, data: { ...data } });\n    return newArea;\n  }\n\n  public async deleteArea(id: number): Promise<Area> {\n    if (isEmpty(id)) throw new HttpException(400, \"User doesn't existId\");\n\n    const findArea: Area = await this.areas.findUnique({ where: { id: id } });\n    if (!findArea) throw new HttpException(409, \"User doesn't exist\");\n\n    const deleteAreaData = await this.areas.update({ where: { id: id }, data: { ...findArea, active: false } });\n    return deleteAreaData;\n  }\n}\n\nexport default AreaService;\n"],"names":["AreaService","getAllAreas","allAreas","areas","findMany","where","active","orderBy","order","getAreaGivenId","id","isEmpty","HttpException","findArea","findUnique","createArea","areaData","name","count","createAreaData","create","data","updateArea","newArea","update","deleteArea","deleteAreaData","PrismaClient","area"],"mappings":"AAAA;;;;+BA8DA;;aAAA;;wBA7DyC;+BAEX;sBACN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGxB,IAAA,AAAMA,cAAN,MAAMA;IAGJ,MAAaC,cAA+B;QAC1C,MAAMC,WAAmB,MAAM,IAAI,CAACC,KAAK,CAACC,QAAQ,CAAC;YACjDC,OAAO;gBAAEC,QAAQ,IAAI;YAAC;YACtBC,SAAS;gBACPC,OAAO;YACT;QACF;QACA,OAAON;IACT;IAEA,MAAaO,eAAeC,EAAU,EAAiB;QACrD,IAAIC,IAAAA,aAAO,EAACD,KAAK,MAAM,IAAIE,4BAAa,CAAC,KAAK,eAAe;QAE7D,MAAMC,WAAiB,MAAM,IAAI,CAACV,KAAK,CAACW,UAAU,CAAC;YAAET,OAAO;gBAAEK,IAAIA;YAAG;QAAE;QACvE,IAAI,CAACG,YAAaA,YAAY,CAACA,SAASP,MAAM,EAAG,MAAM,IAAIM,4BAAa,CAAC,KAAK,sBAAsB;QAEpG,OAAOC;IACT;IAEA,MAAaE,WAAWC,QAAuB,EAAiB;QAC9D,IAAIL,IAAAA,aAAO,EAACK,WAAW,MAAM,IAAIJ,4BAAa,CAAC,KAAK,qBAAqB;QAEzE,MAAMC,WAAiB,MAAM,IAAI,CAACV,KAAK,CAACW,UAAU,CAAC;YAAET,OAAO;gBAAEY,MAAMD,SAASC,IAAI;YAAC;QAAE;QACpF,IAAIJ,UAAU,MAAM,IAAID,4BAAa,CAAC,KAAK,CAAC,gBAAgB,EAAEI,SAASC,IAAI,CAAC,eAAe,CAAC,EAAE;QAE9F,MAAMC,QAAQ,MAAM,IAAI,CAACf,KAAK,CAACe,KAAK,CAAC;YAAEb,OAAO;gBAAEC,QAAQ,IAAI;YAAC;QAAE;QAE/D,MAAMa,iBAAuB,MAAM,IAAI,CAAChB,KAAK,CAACiB,MAAM,CAAC;YAAEC,MAAM,qCAAKL;gBAAUR,OAAOU,QAAQ;;QAAI;QAC/F,OAAOC;IACT;IAEA,MAAaG,WAAWZ,EAAU,EAAEW,IAAmB,EAAiB;QACtE,IAAIV,IAAAA,aAAO,EAACU,OAAO,MAAM,IAAIT,4BAAa,CAAC,KAAK,qBAAqB;QAErE,MAAMC,WAAiB,MAAM,IAAI,CAACV,KAAK,CAACW,UAAU,CAAC;YAAET,OAAO;gBAAEK,IAAIA;YAAG;QAAE;QACvE,IAAI,CAACG,YAAaA,YAAY,CAACA,SAASP,MAAM,EAAG,MAAM,IAAIM,4BAAa,CAAC,KAAK,sBAAsB;QAEpG,MAAMW,UAAU,MAAM,IAAI,CAACpB,KAAK,CAACqB,MAAM,CAAC;YAAEnB,OAAO;gBAAEK,IAAIA;YAAG;YAAGW,MAAM,kBAAKA;QAAO;QAC/E,OAAOE;IACT;IAEA,MAAaE,WAAWf,EAAU,EAAiB;QACjD,IAAIC,IAAAA,aAAO,EAACD,KAAK,MAAM,IAAIE,4BAAa,CAAC,KAAK,wBAAwB;QAEtE,MAAMC,WAAiB,MAAM,IAAI,CAACV,KAAK,CAACW,UAAU,CAAC;YAAET,OAAO;gBAAEK,IAAIA;YAAG;QAAE;QACvE,IAAI,CAACG,UAAU,MAAM,IAAID,4BAAa,CAAC,KAAK,sBAAsB;QAElE,MAAMc,iBAAiB,MAAM,IAAI,CAACvB,KAAK,CAACqB,MAAM,CAAC;YAAEnB,OAAO;gBAAEK,IAAIA;YAAG;YAAGW,MAAM,qCAAKR;gBAAUP,QAAQ,KAAK;;QAAG;QACzG,OAAOoB;IACT;;aAnDOvB,QAAQ,IAAIwB,oBAAY,GAAGC,IAAI;;AAoDxC;MAEA,WAAe5B"}